## Sub Chart Name - pharia-kernel
## Sub Chart Version - 0.2.59
## Release Date - 2025-06-04

### Description of Changes:

The changes introduced in this version include a major refactoring of the tool server store, tool store, and namespace management. The tool server store is now fully isolated, and the tool store has been modified to include a list in the namespace method. The code has been refactored to introduce a tool server store, remove empty namespaces from the tool store, and silence Clippy warnings. Additionally, several tests have been updated to use derive doubles for various components, and the code has been modified to pass the namespace to various APIs and drivers. The MCP servers are now configured only for the skill namespace, and the code has been refactored to remove manual dummy implementations and derive doubles for various components.

### Added

- Add explicit type for MCP server URL
- Add MCP servers as set
- Add basic tracing to tool calls
- Add upsert tool method
- Add CsiDouble trait
- Support json content type for MCP server initialize response
- Add comment about possible application/json response

### Changed

- Release v0.12.12
- Fully isolate tool server store
- Tool store has list in namespace method
- Introduce tool server store
- Silence clippy warning to be able to integrate for now
- List tools takes namespace argument
- Only mcp servers configured for the skill namespace are accessed
- Pass namespace to tool api
- Skill invocation ctx owns namespace
- Namespace is passed to skill invocation ctx
- Pass namespace to skill driver
- Remove manual dummy implementation for CsiForSkills
- Derive SkillDouble
- Derive ToolDouble
- Derive double for search client
- Derive double for Search Api
- Derive McpServerStoreDouble
- Derive doubles for InferenceClient
- Unify SkillRuntime Spys and derive from double
- Double for InferenceApi
- Rename ToolStoreDummy -> McpServerStoreDummy
- Use proc macro for CsiForSkillDouble
- Generate ToolDouble
- Generate CsiDouble
- Rename ToolStoreApi to McpServerStore
- Specify problem with port acquiring strategy
- Align variable names of description
- Use different struct for namespace deserialization
- Tool store stores servers per namespace
- Upsert message to tool store includes namespace
- Mcp servers are read from watch and in place configs
- Mcp servers can be removed from tool store api
- Upserted mcp servers are reported
- Namespace description loader stores descriptions
- Namespace description is reported
- Load mcp servers from config file
- Pharia-1-llm to lowercase everywhere for consistency
- Extract ToolStoreApi interface from ToolApi
- Revert "build(deps): bump the minor group across 1 directory with 36 updates"
- Specify learnings about WIT
- Bump the minor group across 1 directory with 36 updates
- Use serde value type instead of vec<u8> for json representation
- Do requests for list tool in parallel
- Tool actor answers request in parallel
- Toolapi can list tools from server
- Mcp client can list tool names
- Simplify parsing of tool call result
- Mcp client owns http client
- Reorder methods
- Make json rpc response generic for deserialization
- Move initialize to impl block of client
- Split tool into actor + client
- Introduce tool client trait
- Introduce mcp client
- Namespace watcher reports hardcoded tool server
- Mcp servers are stored in hashmap
- Introduce tool actor
- Namespace watchers can talk to tool api
- Csi drivers are generic over tool
- Introduce tool api trait
- Pass trace context to invoke_tool
- Move invoke_tool to csi drivers
- Mcp address is parametrized

### Fixed

- Use derive double for McpServerStore
- Use derive double for tool client
- Specify log level in upper case to make fast mcp happy
- Compare list of servers as hashset, fixes an ordering issue
- Only load mcp servers in config with beta flag
- Update deserialization tests to use actual namespace from_str function
- Mcp server binds to free port
- Use pharia-1-llm for special tokens test to not depent on llama
- One bad mcp server allows to invoke tools on others
- All mcp servers are asked for their tools
- Stub csi uses helper trait
- StubCsi implemented via new CsiDouble helper trait
- Mcp client ignores notification messages
- Also parse invoke tool response application/json
- Invoke tool against json mcp server
- Mcp python server supports port and json response config
- Invoking an unknown tool gives error
- Initialize with mcp server before invoking tool
- Initialize request against mcp server

### Removed

- Remove empty namespace from tool store
- Remove unused name argument when configuring tool server
- Remove unused MCP servers map
- Remove unneeded implementations on CsiSaboteur

### Related Issues/Links:
- [Jira Board](https://aleph-alpha.atlassian.net/jira/software/projects/PK/boards/160)

### Notes:
- Generated by git-cliff
- The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).
